function visavailChart(t,e){function a(t){return(d3.timeSecond(t)<t?d3.timeFormat(r.customTimeFormat.formatMillisecond):d3.timeMinute(t)<t?d3.timeFormat(r.customTimeFormat.formatSecond):d3.timeHour(t)<t?d3.timeFormat(r.customTimeFormat.formatMinute):d3.timeDay(t)<t?d3.timeFormat(r.customTimeFormat.formatHour):d3.timeMonth(t)<t?d3.timeWeek(t)<t?d3.timeFormat(r.customTimeFormat.formatDay):d3.timeFormat(r.customTimeFormat.formatWeek):d3.timeYear(t)<t?d3.timeFormat(r.customTimeFormat.formatMonth):d3.timeFormat(r.customTimeFormat.formatYear))(t)}function n(t){t.each(function(e){function n(t){w.select("#vGrid").selectAll("line.vert_grid").data(t.ticks()).enter().append("line").attr("x1",function(e){return t(e)}).attr("x2",function(e){return t(e)}).attr("y1",0).attr("y2",r.barHeight*g+r.lineSpacing*g-1+r.paddingBottom).attr("class","vert_grid")}function i(t){return+t===+new Date(t.getFullYear(),0,1,0,0,0)}function o(t){return+t===+new Date(t.getFullYear(),t.getMonth(),1,0,0,0)}function s(t){var e=t.ticks(),a=e.map(i),n=e.map(o);r.emphasizeYearTicks&&!a.every(function(t){return t===!0})&&n.every(function(t){return t===!0})&&(d3.selectAll("g.tick").each(function(t,e){a[e]&&d3.select(this).attr("class","tick x_tick_emph")}),d3.selectAll(".vert_grid").each(function(t,e){a[e]&&d3.select(this).attr("class","vert_grid vert_grid_emph")})),r.emphasizeMonthTicks&&!n.every(function(t){return t===!0})&&(d3.selectAll("g.tick").each(function(t,e){n[e]&&d3.select(this).attr("class","tick x_tick_emph")}),d3.selectAll(".vert_grid").each(function(t,e){n[e]&&d3.select(this).attr("class","vert_grid vert_grid_emph")}))}function d(){null==d3.event.sourceEvent&&"zoom"!==d3.event.type||(r.xScale=d3.event.transform.rescaleX(b),null!==d3.event.sourceEvent&&"zoom"==d3.event.type&&l.style("left",event.pageX+"px"),Y.selectAll("rect").attr("x",function(t){return r.xScale(t[0])<0?0:r.xScale(t[0])}).attr("width",function(t){return r.xScale(t[2])-r.xScale(t[0])<0||r.xScale(t[2])<0&&r.xScale(t[1])<0?0:r.xScale(t[0])<0&&r.xScale(t[2])>0?r.xScale(t[2]):r.xScale(t[2])<0&&r.xScale(t[1])>0?r.xScale(t[1]):r.xScale(t[2])-r.xScale(t[0])}),w.select(".xAxis").call(M.scale(r.xScale)),w.select("#vGrid").selectAll("line").remove(),n(r.xScale),s(r.xScale),r.zoom.onzoom.call(this,r.xScale.domain()))}d3.timeFormatDefaultLocale(r.locale);var c,m,p=r.width-r.margin.left-r.margin.right,f=0;0!==r.maxDisplayDatasets?(c=r.curDisplayFirstDataset,m=r.curDisplayFirstDataset+r.maxDisplayDatasets>e.length?e.length:r.curDisplayFirstDataset+r.maxDisplayDatasets,f=Math.ceil(e.length/r.maxDisplayDatasets)):(c=0,m=e.length),t.attr("data-max-pages",f);var g=m-c,u=r.barHeight*g+r.lineSpacing*g-1;r.definedBlocks=!1;for(var h=0;h<e.length;h++){if(e[h].description&&(r.tooltip.description=!0),3===e[h].data[0].length){r.definedBlocks=!0;break}if(r.definedBlocks)throw new Error("Detected different data formats in input data. Format can either be continuous data format or time gap data format but not both.")}var _=d3.timeParse("%Y-%m-%d"),x=d3.timeParse("%Y-%m-%d %H:%M:%S"),y=new RegExp(/^\d{4}-\d{2}-\d{2}$/),v=new RegExp(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/);e.forEach(function(t){t.data.forEach(function(e){if(!(e[0]instanceof Date)){if(y.test(e[0]))e[0]=_(e[0]);else{if(!v.test(e[0]))throw new Error("Date/time format not recognized. Pick between 'YYYY-MM-DD' or 'YYYY-MM-DD HH:MM:SS'.");e[0]=x(e[0]),r.isDateOnlyFormat=!1}if(r.definedBlocks)if(y.test(e[2]))e[2]=_(e[2]);else{if(!v.test(e[2]))throw new Error("Date/time format not recognized. Pick between 'YYYY-MM-DD' or 'YYYY-MM-DD HH:MM:SS'.");e[2]=x(e[2])}else e[2]=d3.timeSecond.offset(e[0],t.interval_s)}})}),e.forEach(function(t,a){var n=[],i=t.data.length;t.data.forEach(function(t,e){0!==e&&e<i?t[1]===n[n.length-1][1]?r.definedBlocks?n[n.length-1][2].getTime()===t[0].getTime()?(n[n.length-1][2]=t[2],n[n.length-1][3]=1):n.push(t):(n[n.length-1][2]=t[2],n[n.length-1][3]=1):(t[3]=0,r.definedBlocks||(n[n.length-1][2]=t[0]),n.push(t)):0===e&&(t[3]=0,n.push(t))}),e[a].disp_data=n});var D=r.displayDateRange[0],S=r.displayDateRange[1];if(0!==D&&(D=moment(D)),0!==S&&(S=moment(S)),0!==r.displayDateRange[0]&&0!==r.displayDateRange[1]||e.forEach(function(t,e){t.disp_data.length>0&&(0===D&&0===S?(D=t.disp_data[0][0],S=t.disp_data[t.disp_data.length-1][2]):(0===r.displayDateRange[0]&&t.disp_data[0][0]<D&&(D=t.disp_data[0][0]),0===r.displayDateRange[1]&&t.disp_data[t.disp_data.length-1][2]>S&&(S=t.disp_data[t.disp_data.length-1][2])))}),r.xScale)var b=r.xScale.range([0,p]);else var b=d3.scaleTime().domain([D,S]).range([0,p]);var M=d3.axisTop().scale(b).tickFormat(a),w=d3.select(this).append("svg").attr("width",p+r.margin.left+r.margin.right).attr("height",u+r.margin.top+r.margin.bottom).append("g").attr("transform","translate("+r.margin.left+","+r.margin.top+")");if(w.append("g").attr("id","g_title"),w.append("g").attr("id","g_axis"),r.zoom.enabled){var T=d3.zoom().on("zoom",d).on("start",function(){var t=d3.event;t&&"brush"===t.type||(startEvent=t,r.zoom.onzoomstart.call(this,t))}).on("end",function(){var t=d3.event.sourceEvent;t&&"brush"===t.type||t&&startEvent.clientX===t.clientX&&startEvent.clientY===t.clientY||r.zoom.onzoomend.call(this,r.xScale.domain())});w.append("rect").attr("id","zoom").attr("width",p).attr("height",u).attr("fill-opacity",0).attr("cursor","ew-resize").attr("x",0).attr("y",0),w.call(T)}if(w.append("g").attr("id","g_data"),r.ytitle){var k=w.select("#g_axis").append("g").attr("id","yAxis").selectAll("text").data(e.slice(c,m)).enter();k.append("text").attr("x",r.paddingLeft).attr("y",r.lineSpacing+r.barHeight/2).text(function(t){if(null==t.measure_html)return t.measure}).attr("transform",function(t,e){return"translate(0,"+(r.lineSpacing+r.barHeight)*e+")"}).attr("class",function(t){var e="ytitle";return null!=t.measure_url&&(e+=" link"),e}).on("click",function(t){return null!=t.measure_url?window.open(t.measure_url):null}),k.append("foreignObject").attr("x",r.paddingLeft).attr("y",r.lineSpacing).attr("transform",function(t,e){return"translate(0,"+(r.lineSpacing+r.barHeight)*e+")"}).attr("width",-1*r.paddingLeft).attr("height",r.barHeight).attr("class","ytitle").html(function(t){if(null!=t.measure_html)return t.measure_html})}w.select("#g_axis").append("g").attr("id","vGrid"),g&&n(b),w.select("#g_axis").append("g").attr("id","hGrid").selectAll("line.horz_grid").data(e).enter().append("line").attr("x1",0).attr("x2",p).attr("y1",function(t,e){return(r.lineSpacing+r.barHeight)*e+r.lineSpacing+r.barHeight/2}).attr("y2",function(t,e){return(r.lineSpacing+r.barHeight)*e+r.lineSpacing+r.barHeight/2}).attr("class","horz_grid"),g&&w.select("#g_axis").append("g").attr("class","xAxis").call(M);var Y=w.select("#g_data").selectAll(".g_data").data(e.slice(c,m)).enter().append("g").attr("transform",function(t,e){return"translate(0,"+(r.lineSpacing+r.barHeight)*e+")"}).attr("cursor","pointer").attr("class","dataset");if(Y.selectAll("rect").data(function(t){return t.disp_data}).enter().append("rect").attr("x",function(t){return b(t[0])<0?0:b(t[0])}).attr("width",function(t){return b(t[2])-b(t[0])<0||b(t[2])<0&&b(t[1])<0?0:b(t[0])<0&&b(t[2])>0?b(t[2]):b(t[2])<0&&b(t[1])>0?b(t[1]):b(t[2])-b(t[0])}).attr("y",r.lineSpacing).attr("height",r.barHeight).attr("class",function(t){if(!r.definedBlocks)return 1===t[1]?"rect_has_data":"rect_has_no_data";var a=e.filter(function(e){return e.disp_data.indexOf(t)>=0})[0];return a&&a.categories?(d3.select(this).attr("fill",a.categories[t[1]].color),""):void 0}).on("mouseover",function(t,a){var n=this.getScreenCTM().translate(+this.getAttribute("x"),+this.getAttribute("y"));l.transition().duration(200).style("opacity",.9),l.html(function(){var n="";if(n=r.definedBlocks?"&nbsp;"+t[1]+"&nbsp;":1===t[1]?'<i class=" '+r.icon.class_has_data+' tooltip_has_data"></i>':'<i class=" '+r.icon.class_has_no_data+' tooltip_has_no_data"></i>',r.tooltip.description){var i=e.filter(function(e){return e.disp_data.indexOf(t)>=0})[0];i&&i.description&&i.description[a]&&(n+=" "+i.description[a]+" ")}return r.isDateOnlyFormat?t[2]>d3.timeSecond.offset(t[0],86400)?n+moment(t[0]).format("l")+" - "+moment(t[2]).format("l"):n+moment(t[0]).format("l"):t[2]>d3.timeSecond.offset(t[0],86400)?n+moment(t[0]).format("l")+" "+moment(t[0]).format("LTS")+" - "+moment(t[2]).format("l")+" "+moment(t[2]).format("LTS"):n+moment(t[0]).format("LTS")+" - "+moment(t[2]).format("LTS")}).style("left",function(){return event.pageX+"px"}).style("top",function(){return window.pageYOffset+n.f-r.tooltip.height+"px"}).style("height",r.barHeight+r.tooltip.height+"px")}).on("mouseout",function(){l.transition().duration(500).style("opacity",0)}).on("mousemove",function(){l.style("left",event.pageX+"px")}),s(b),r.title.enabled&&w.select("#g_title").append("text").attr("x",r.paddingLeft).attr("y",r.paddingTopHeading).text(r.title.text).attr("class","heading"),r.sub_title.enabled){var F="";g&&(F=r.isDateOnlyFormat?r.sub_title.from_text+" "+moment(D).format("MMMM Y")+" "+r.sub_title.to_text+" "+moment(S).format("MMMM Y"):r.sub_title.from_text+" "+moment(D).format("l")+" "+moment(D).format("LTS")+" "+r.sub_title.to_text+" "+moment(S).format("l")+" "+moment(S).format("LTS")),w.select("#g_title").append("text").attr("x",r.paddingLeft).attr("y",r.paddingTopHeading+17).text(F).attr("class","subheading")}if(!r.definedBlocks&&r.legend.enabled){var H=w.select("#g_title").append("g").attr("id","g_legend").attr("transform","translate(0,-12)");H.append("rect").attr("x",p+r.margin.right-150).attr("y",r.paddingTopHeading).attr("height",15).attr("width",15).attr("class","rect_has_data"),H.append("text").attr("x",p+r.margin.right-150+20).attr("y",r.paddingTopHeading+8.5).text(r.legend.has_data_text).attr("class","legend"),H.append("rect").attr("x",p+r.margin.right-150).attr("y",r.paddingTopHeading+17).attr("height",15).attr("width",15).attr("class","rect_has_no_data"),H.append("text").attr("x",p+r.margin.right-150+20).attr("y",r.paddingTopHeading+8.5+15+2).text(r.legend.has_no_data_text).attr("class","legend")}})}function i(){n.resizeWidth(r.id_div_graph,document.getElementById(r.id_div_container).offsetWidth)}var r={id_div_container:"visavail_container",id_div_graph:"example",margin:{top:70,right:40,bottom:20,left:100},width:940,barHeight:18,lineSpacing:14,paddingTopHeading:-50,paddingBottom:10,paddingLeft:-100,emphasizeYearTicks:!0,emphasizeMonthTicks:!0,maxDisplayDatasets:0,curDisplayFirstDataset:0,displayDateRange:[0,0],customCategories:!1,isDateOnlyFormat:!0,tooltip:{class:"tooltip",height:11},legend:{enabled:!0,has_no_data_text:"No Data available",has_data_text:"Data available"},title:{enabled:!0,text:"Data Availability Plot"},sub_title:{enabled:!0,from_text:"from",to_text:"to"},ytitle:!0,icon:{class_has_data:"fas fa-fw fa-check",class_has_no_data:"fas fa-fw fa-times"},locale:{dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:moment.weekdays(),shortDays:moment.weekdaysShort(),months:moment.months(),shortMonths:moment.monthsShort()},customTimeFormat:{formatMillisecond:".%L",formatSecond:":%S",formatMinute:"%H:%M",formatHour:"%H",formatDay:"%a %d",formatWeek:"%b %d",formatMonth:"%B",formatYear:"%Y"},zoom:{enabled:!0,onzoom:function(){},onzoomstart:function(){},onzoomend:function(){}},responsive:!0};if(null!=t)for(var o in t)if(r.hasOwnProperty(o))if("object"==typeof r[o])for(var s in t[o])r[o].hasOwnProperty(s)&&(r[o][s]=t[o][s]);else r[o]=t[o];var l=d3.select("body").append("div").attr("class",r.tooltip.class).style("opacity",0);return n.width=function(t){return arguments.length?(r.width=t,n):r.width},n.drawTitle=function(t){return arguments.length?(r.title.enabled=t,n):r.title.enabled},n.maxDisplayDatasets=function(t){return arguments.length?(r.maxDisplayDatasets=t,n):r.maxDisplayDatasets},n.curDisplayFirstDataset=function(t){return arguments.length?(r.curDisplayFirstDataset=t,n):r.curDisplayFirstDataset},n.emphasizeYearTicks=function(t){return arguments.length?(r.emphasizeYearTicks=t,n):r.emphasizeYearTicks},n.displayDateRange=function(t,e){return arguments.length?(r.displayDateRange=e,n.updateGraph(t)):r.displayDateRange},n.resizeWidth=function(t,e){return r.width=e,n.updateGraph(t)},n.updateGraph=function(t,e){return document.getElementById(t).innerHTML="",e?createGraph(t,e):(d3.select("#"+t).call(n),n)},n.createGraph=function(t,e){return d3.select("#"+t).datum(e).call(n),n},r.responsive&&window.addEventListener("resize",i),n.createGraph(r.id_div_graph,e),n}