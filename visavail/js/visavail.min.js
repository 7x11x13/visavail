function visavailChart(t){function e(t){return(d3.timeSecond(t)<t?d3.timeFormat(n.customTimeFormat.formatMillisecond):d3.timeMinute(t)<t?d3.timeFormat(n.customTimeFormat.formatSecond):d3.timeHour(t)<t?d3.timeFormat(n.customTimeFormat.formatMinute):d3.timeDay(t)<t?d3.timeFormat(n.customTimeFormat.formatHour):d3.timeMonth(t)<t?d3.timeWeek(t)<t?d3.timeFormat(n.customTimeFormat.formatDay):d3.timeFormat(n.customTimeFormat.formatWeek):d3.timeYear(t)<t?d3.timeFormat(n.customTimeFormat.formatMonth):d3.timeFormat(n.customTimeFormat.formatYear))(t)}function a(t){t.each(function(a){function i(t){M.select("#vGrid").selectAll("line.vert_grid").data(t.ticks()).enter().append("line").attr("x1",function(e){return t(e)}).attr("x2",function(e){return t(e)}).attr("y1",0).attr("y2",n.barHeight*p+n.lineSpacing*p-1+n.paddingBottom).attr("class","vert_grid")}function r(t){return+t===+new Date(t.getFullYear(),0,1,0,0,0)}function s(t){return+t===+new Date(t.getFullYear(),t.getMonth(),1,0,0,0)}function l(){d3.event.sourceEvent&&"brush"===d3.event.sourceEvent.type||(n.xScale=d3.event.transform.rescaleX(S),T.selectAll("rect").data(function(t){return t.disp_data}).attr("x",function(t){return n.xScale(t[0])<0?0:n.xScale(t[0])}).attr("width",function(t){return n.xScale(t[2])-n.xScale(t[0])<0?0:n.xScale(t[2])-n.xScale(t[0])}),M.select(".xAxis").call(v.scale(n.xScale)),M.select("#vGrid").selectAll("line").remove(),i(n.xScale))}d3.timeFormatDefaultLocale(n.locale);var d,m,c=n.width-n.margin.left-n.margin.right,g=0;0!==n.maxDisplayDatasets?(d=n.curDisplayFirstDataset,m=n.curDisplayFirstDataset+n.maxDisplayDatasets>a.length?a.length:n.curDisplayFirstDataset+n.maxDisplayDatasets,g=Math.ceil(a.length/n.maxDisplayDatasets)):(d=0,m=a.length),t.attr("data-max-pages",g);var p=m-d,f=n.barHeight*p+n.lineSpacing*p-1;if(null===n.definedBlocks){n.definedBlocks=0;for(var u=0;u<a.length;u++){if(3===a[u].data[0].length){n.definedBlocks=1;break}if(n.definedBlocks)throw new Error("Detected different data formats in input data. Format can either be continuous data format or time gap data format but not both.")}}var h=d3.timeParse("%Y-%m-%d"),_=d3.timeParse("%Y-%m-%d %H:%M:%S"),x=new RegExp(/^\d{4}-\d{2}-\d{2}$/),y=new RegExp(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/);a.forEach(function(t){t.data.forEach(function(e){if(!(e[0]instanceof Date)){if(x.test(e[0]))e[0]=h(e[0]);else{if(!y.test(e[0]))throw new Error("Date/time format not recognized. Pick between 'YYYY-MM-DD' or 'YYYY-MM-DD HH:MM:SS'.");e[0]=_(e[0]),n.isDateOnlyFormat=!1}if(n.definedBlocks)if(x.test(e[2]))e[2]=h(e[2]);else{if(!y.test(e[2]))throw new Error("Date/time format not recognized. Pick between 'YYYY-MM-DD' or 'YYYY-MM-DD HH:MM:SS'.");e[2]=_(e[2])}else e[2]=d3.timeSecond.offset(e[0],t.interval_s)}})}),a.forEach(function(t,e){var i=[],r=t.data.length;t.data.forEach(function(t,e){0!==e&&e<r?t[1]===i[i.length-1][1]?n.definedBlocks?i[i.length-1][2].getTime()===t[0].getTime()?(i[i.length-1][2]=t[2],i[i.length-1][3]=1):i.push(t):(i[i.length-1][2]=t[2],i[i.length-1][3]=1):(t[3]=0,n.definedBlocks||(i[i.length-1][2]=t[0]),i.push(t)):0===e&&(t[3]=0,i.push(t))}),a[e].disp_data=i});var D=n.displayDateRange[0],b=n.displayDateRange[1];if(0!==D&&(D=moment(D)),0!==b&&(b=moment(b)),0!==n.displayDateRange[0]&&0!==n.displayDateRange[1]||a.forEach(function(t,e){t.disp_data.length>0&&(0===D&&0===b?(D=t.disp_data[0][0],b=t.disp_data[t.disp_data.length-1][2]):(0===n.displayDateRange[0]&&t.disp_data[0][0]<D&&(D=t.disp_data[0][0]),0===n.displayDateRange[1]&&t.disp_data[t.disp_data.length-1][2]>b&&(b=t.disp_data[t.disp_data.length-1][2])))}),n.xScale)var S=n.xScale.range([0,c]);else var S=d3.scaleTime().domain([D,b]).range([0,c]);var v=d3.axisTop().scale(S).tickFormat(e),M=d3.select(this).append("svg").attr("width",c+n.margin.left+n.margin.right).attr("height",f+n.margin.top+n.margin.bottom).append("g").attr("transform","translate("+n.margin.left+","+n.margin.top+")");if(M.append("g").attr("id","g_title"),M.append("g").attr("id","g_axis"),M.append("g").attr("id","g_data"),n.ytitle){var w=M.select("#g_axis").append("g").attr("id","yAxis").selectAll("text").data(a.slice(d,m)).enter();w.append("text").attr("x",n.paddingLeft).attr("y",n.lineSpacing+n.barHeight/2).text(function(t){if(null==t.measure_html)return t.measure}).attr("transform",function(t,e){return"translate(0,"+(n.lineSpacing+n.barHeight)*e+")"}).attr("class",function(t){var e="ytitle";return null!=t.measure_url&&(e+=" link"),e}).on("click",function(t){return null!=t.measure_url?window.open(t.measure_url):null}),w.append("foreignObject").attr("x",n.paddingLeft).attr("y",n.lineSpacing).attr("transform",function(t,e){return"translate(0,"+(n.lineSpacing+n.barHeight)*e+")"}).attr("width",-1*n.paddingLeft).attr("height",n.barHeight).attr("class","ytitle").html(function(t){if(null!=t.measure_html)return t.measure_html})}M.select("#g_axis").append("g").attr("id","vGrid"),p&&i(S),M.select("#g_axis").append("g").attr("id","hGrid").selectAll("line.horz_grid").data(a).enter().append("line").attr("x1",0).attr("x2",c).attr("y1",function(t,e){return(n.lineSpacing+n.barHeight)*e+n.lineSpacing+n.barHeight/2}).attr("y2",function(t,e){return(n.lineSpacing+n.barHeight)*e+n.lineSpacing+n.barHeight/2}).attr("class","horz_grid"),p&&M.select("#g_axis").append("g").attr("class","xAxis").call(v);var T=M.select("#g_data").selectAll(".g_data").data(a.slice(d,m)).enter().append("g").attr("transform",function(t,e){return"translate(0,"+(n.lineSpacing+n.barHeight)*e+")"}).attr("class","dataset");T.selectAll("rect").data(function(t){return t.disp_data}).enter().append("rect").attr("x",function(t){return S(t[0])<0?0:S(t[0])}).attr("y",n.lineSpacing).attr("width",function(t){return S(t[2])-S(t[0])<0?0:S(t[2])-S(t[0])}).attr("height",n.barHeight).attr("class",function(t){if(!n.definedBlocks)return 1===t[1]?"rect_has_data":"rect_has_no_data";var e=a.filter(function(e){return e.disp_data.indexOf(t)>=0})[0];return e&&e.categories?(d3.select(this).attr("fill",e.categories[t[1]].color),""):void 0}).on("mouseover",function(t,e){var a=this.getScreenCTM().translate(+this.getAttribute("x"),+this.getAttribute("y"));o.transition().duration(200).style("opacity",.9),o.html(function(){var e="";return e=n.definedBlocks?"&nbsp;"+t[1]+"&nbsp;":1===t[1]?'<i class=" '+n.icon.class_has_data+' tooltip_has_data"></i>':'<i class=" '+n.icon.class_has_no_data+' tooltip_has_no_data"></i>',n.isDateOnlyFormat?t[2]>d3.timeSecond.offset(t[0],86400)?e+moment(t[0]).format("l")+" - "+moment(t[2]).format("l"):e+moment(t[0]).format("l"):t[2]>d3.timeSecond.offset(t[0],86400)?e+moment(t[0]).format("l")+" "+moment(t[0]).format("LTS")+" - "+moment(t[2]).format("l")+" "+moment(t[2]).format("LTS"):e+moment(t[0]).format("LTS")+" - "+moment(t[2]).format("LTS")}).style("left",function(){return window.pageXOffset+a.e+"px"}).style("top",function(){return window.pageYOffset+a.f-n.tooltip.height+"px"}).style("height",n.barHeight+n.tooltip.height+"px")}).on("mouseout",function(){o.transition().duration(500).style("opacity",0)});var F=S.ticks();F.map(r),F.map(s);if(n.title.enabled&&M.select("#g_title").append("text").attr("x",n.paddingLeft).attr("y",n.paddingTopHeading).text(n.title.text).attr("class","heading"),n.sub_title.enabled){var H="";p&&(H=n.isDateOnlyFormat?n.sub_title.from_text+" "+moment(D).format("MMMM Y")+" "+n.sub_title.to_text+" "+moment(b).format("MMMM Y"):n.sub_title.from_text+" "+moment(D).format("l")+" "+moment(D).format("LTS")+" "+n.sub_title.to_text+" "+moment(b).format("l")+" "+moment(b).format("LTS")),M.select("#g_title").append("text").attr("x",n.paddingLeft).attr("y",n.paddingTopHeading+17).text(H).attr("class","subheading")}if(!n.definedBlocks&&n.legend.enabled){var Y=M.select("#g_title").append("g").attr("id","g_legend").attr("transform","translate(0,-12)");Y.append("rect").attr("x",c+n.margin.right-150).attr("y",n.paddingTopHeading).attr("height",15).attr("width",15).attr("class","rect_has_data"),Y.append("text").attr("x",c+n.margin.right-150+20).attr("y",n.paddingTopHeading+8.5).text(n.legend.has_data_text).attr("class","legend"),Y.append("rect").attr("x",c+n.margin.right-150).attr("y",n.paddingTopHeading+17).attr("height",15).attr("width",15).attr("class","rect_has_no_data"),Y.append("text").attr("x",c+n.margin.right-150+20).attr("y",n.paddingTopHeading+8.5+15+2).text(n.legend.has_no_data_text).attr("class","legend")}var k=d3.zoom().on("zoom",l);M.select("#g_data").call(k)})}var n={margin:{top:70,right:40,bottom:20,left:100},width:940,barHeight:18,lineSpacing:14,paddingTopHeading:-50,paddingBottom:10,paddingLeft:-100,emphasizeYearTicks:!0,emphasizeMonthTicks:!0,maxDisplayDatasets:0,curDisplayFirstDataset:0,displayDateRange:[0,0],definedBlocks:null,customCategories:!1,isDateOnlyFormat:!0,tooltip:{class:"tooltip",height:11},legend:{enabled:!0,has_no_data_text:"No Data available",has_data_text:"Data available"},title:{enabled:!0,text:"Data Availability Plot"},sub_title:{enabled:!0,from_text:"from",to_text:"to"},ytitle:!0,icon:{class_has_data:"fas fa-fw fa-check",class_has_no_data:"fas fa-fw fa-times"},locale:{dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:moment.weekdays(),shortDays:moment.weekdaysShort(),months:moment.months(),shortMonths:moment.monthsShort()},customTimeFormat:{formatMillisecond:".%L",formatSecond:":%S",formatMinute:"%H:%M",formatHour:"%H",formatDay:"%a %d",formatWeek:"%b %d",formatMonth:"%B",formatYear:"%Y"}};if(null!=t)for(var i in t)if(n.hasOwnProperty(i))if("object"==typeof n[i])for(var r in t[i])n[i].hasOwnProperty(r)&&(n[i][r]=t[i][r]);else n[i]=t[i];var o=d3.select("body").append("div").attr("class",n.tooltip.class).style("opacity",0);return a.width=function(t){return arguments.length?(n.width=t,a):n.width},a.drawTitle=function(t){return arguments.length?(n.title.enabled=t,a):n.title.enabled},a.maxDisplayDatasets=function(t){return arguments.length?(n.maxDisplayDatasets=t,a):n.maxDisplayDatasets},a.curDisplayFirstDataset=function(t){return arguments.length?(n.curDisplayFirstDataset=t,a):n.curDisplayFirstDataset},a.emphasizeYearTicks=function(t){return arguments.length?(n.emphasizeYearTicks=t,a):n.emphasizeYearTicks},a.displayDateRange=function(t,e){return arguments.length?(n.displayDateRange=e,a.updateGraph(t)):n.displayDateRange},a.resizeWidth=function(t,e){return n.width=e,a.updateGraph(t)},a.updateGraph=function(t){return document.getElementById(t).innerHTML="",d3.select("#"+t).call(a),a},a.createGraph=function(t,e){return d3.select("#"+t).datum(e).call(a),a},a}